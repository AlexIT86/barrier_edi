{% extends 'base/base.html' %}
{% block content %}
<div class="card">
  <div class="card-body">
    <h1 class="h5">Aviz {{ delivery.delivery_number }}</h1>
    <p class="text-muted mb-1">Comandă: {{ delivery.order.order_number }} | Partener: {{ delivery.partner.name }}</p>
    <p class="text-muted">Data livrare: {{ delivery.delivery_date }} | Status: {{ delivery.get_status_display }} | Validare: {{ delivery.get_validation_status_display }}</p>
  </div>
  <div class="card-body border-top">
    <h2 class="h6">Poziții</h2>
    <div class="table-responsive">
      <table class="table table-sm table-striped">
        <thead><tr><th>Poziție</th><th>Material</th><th>Descriere</th><th>Comandat</th><th>Livrat</th><th>Acceptat</th><th>Discrep.</th></tr></thead>
        <tbody>
          {% for item in delivery.items.all %}
          <tr class="{% if item.has_discrepancy %}table-danger{% endif %}">
            <td>{{ item.order_item.position }}</td>
            <td>{{ item.order_item.material_code }}</td>
            <td>{{ item.order_item.material_description }}</td>
            <td>{{ item.order_item.quantity_ordered }}</td>
            <td>{{ item.quantity_delivered }}</td>
            <td>{{ item.quantity_accepted|default:'-' }}</td>
            <td>{% if item.has_discrepancy %}Da{% else %}Nu{% endif %}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  <div class="card-body border-top">
    <h2 class="h6">Note validare</h2>
    <p class="text-muted">{{ delivery.validation_notes|default:'-' }}</p>
  </div>
  <div class="card-footer"><a class="btn btn-secondary" href="{% url 'deliveries:delivery_list' %}">Înapoi</a></div>
</div>
{% endblock %}


